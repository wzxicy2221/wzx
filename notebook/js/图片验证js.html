<html>
<head>
  <title>图片验证js</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/304720 (zh-CN, DDL); Windows/10.0.14393 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="390"/>
<h1>图片验证js</h1>

<div>
<span style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">$</span><span style="font-size:10pt">(</span></font> <font color="#2A00FF" face="Courier New" size="2"><span style="font-size:10pt">&quot;#picture&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">).change(</span></font><font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>function</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(){</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>var</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">s =</span> <span style="font-size:10pt; background:#d4d4d4">$</span><span style="font-size:10pt">(</span></font> <font color="#2A00FF" face="Courier New" size="2"><span style="font-size:10pt">'#pic'</span></font><font face="Courier New" size="2"><span style="font-size:10pt">).val();</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>var</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">start = s.lastIndexOf(</span></font><font color="#2A00FF" face="Courier New" size="2"><span style="font-size:10pt">&quot;.&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">)+1;</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>var</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name = s.substring(start,s.length).toLowerCase();</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>if</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(name!=</span></font><font color="#2A00FF" face="Courier New" size="2"><span style="font-size:10pt">&quot;jpg&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">){</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">            alert(</span></font> <font color="#2A00FF" face="Courier New" size="2"><span style="font-size:10pt">&quot;格式必须为jpg&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>return</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>if</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(</span></font><font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">.files[0].size/1024&gt;200){</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">            alert(</span></font> <font color="#2A00FF" face="Courier New" size="2"><span style="font-size:10pt">&quot;图片过大&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>return</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>var</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">objUrl = getObjectURL(</span></font><font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.files[0]) ;</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>if</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">(objUrl) {</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>var</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">img =</span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Image();</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">            img.dynsrc = objUrl;</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">            alert(img);</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">}) ;</span></font></div><div align="left"><font color="#010101" face="Courier New" size="2"><span style="font-size:10pt"><br/></span></font></div><div align="left"><font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>function</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">getObjectURL(file) {</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>var</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">url =</span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>null</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>if</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">(window.createObjectURL!=</span></font><font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>undefined</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">) {</span></font> <font color="#3F7F5F" face="Courier New" size="2"><span style="font-size:10pt">// basic</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">            url = window.createObjectURL(file) ;</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      }</span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>else</b></span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>if</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">(window.URL!=</span></font><font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>undefined</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">) {</span></font> <font color="#3F7F5F" face="Courier New" size="2"><span style="font-size:10pt">//</span> <span style="font-size:10pt"><u>mozilla</u></span> <span style="font-size:10pt">(</span><span style="font-size:10pt"><u>firefox</u></span><span style="font-size:10pt">)</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">            url = window.URL.createObjectURL(file) ;</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      }</span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>else</b></span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>if</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">(window.webkitURL!=</span></font><font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>undefined</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">) {</span></font> <font color="#3F7F5F" face="Courier New" size="2"><span style="font-size:10pt">//</span> <span style="font-size:10pt"><u>webkit</u></span> <span style="font-size:10pt">or</span> <span style="font-size:10pt"><u>chrome</u></span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">            url = window.webkitURL.createObjectURL(file) ;</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">url ;</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div></span>
</div></body></html> 